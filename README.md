# 发票/支付截图/Excel尺寸调整工具

一个专为报销场景设计的前端工具，帮助您将电子发票PDF、支付截图和Excel文件调整为符合报销单要求的尺寸，并生成可打印的A4页面。

## 🎯 功能特点

- **智能尺寸适配**：根据报销单发票粘贴区域，自动计算最佳缩放比例
- **A4纸输出**：生成标准A4尺寸PDF，方便办公室打印
- **精确裁剪线**：提供虚线边框和角标记，确保裁剪精度
- **预设尺寸**：内置常用报销单尺寸，开箱即用
- **自定义尺寸**：支持输入任意长宽尺寸（1-30cm）
- **拖拽上传**：简单易用的文件上传界面
- **实时预览**：处理后即时预览PDF效果

## 🚀 使用场景

**报销流程优化**：
1. 公司报销单有固定的发票粘贴区域
2. 电子发票PDF尺寸通常不匹配
3. 使用本工具调整发票尺寸
4. 打印A4纸并沿线裁剪
5. 获得完美匹配报销单的发票

## 📋 使用方法

### 1. 启动应用
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 或构建生产版本
npm run build
```

### 2. 操作步骤
1. **上传文件**：拖拽或点击上传PDF格式的电子发票、支付截图(PNG/JPG/WebP)或Excel文件(.xlsx/.xls)
2. **选择尺寸**：
   - 预设尺寸：选择常用报销单规格
   - 自定义尺寸：输入具体的长宽尺寸
3. **生成PDF**：点击"生成A4打印PDF"
4. **下载打印**：下载生成的PDF文件并打印
5. **裁剪发票**：沿着虚线裁剪，获得符合报销单的发票

### 3. 预设尺寸规格
- **小报销单**：5.5×8cm
- **中报销单**：8×12cm  
- **标准报销单**：10×15cm
- **大报销单**：15×20cm
- **超大报销单**：21×11cm

## 🛠 技术架构

- **前端框架**：React + TypeScript
- **PDF处理**：pdf-lib + @pdf-lib/fontkit
- **Excel处理**：xlsx + html2canvas
- **文件上传**：react-dropzone
- **构建工具**：Vite
- **样式**：原生CSS

## 📦 依赖说明

```json
{
  "pdf-lib": "PDF文档创建和操作",
  "@pdf-lib/fontkit": "字体处理支持",
  "xlsx": "Excel文件读取和解析",
  "html2canvas": "HTML转Canvas截图",
  "react-dropzone": "拖拽文件上传",
  "react": "用户界面框架",
  "typescript": "类型安全开发"
}
```

## 🔧 核心功能实现

### 文件处理流程
1. **文件验证**：检查文件格式和完整性
2. **内容解析**：
   - PDF：解析页面和尺寸
   - 图片：转换为Canvas对象
   - Excel：读取工作表并转换为HTML表格，再转Canvas
3. **智能缩放**：按目标尺寸等比例缩放
4. **A4布局**：在A4纸上居中放置缩放后的内容
5. **裁剪辅助**：添加虚线边框和角标记
6. **说明文字**：添加尺寸信息和使用说明

### 缩放算法
```typescript
// 计算最佳缩放比例（保持宽高比）
const scaleX = targetWidth / pageWidth
const scaleY = targetHeight / pageHeight
const scale = Math.min(scaleX, scaleY)
```

## 🎨 界面设计

- **响应式布局**：适配不同屏幕尺寸
- **居中设计**：内容在页面中心显示
- **清晰层次**：明确的功能区域划分
- **友好提示**：详细的错误信息和使用说明

## 🔍 错误处理

应用包含完善的错误处理机制：

- **文件格式验证**：确保上传的是有效PDF文件
- **加密检测**：提示解除PDF密码保护
- **尺寸验证**：检查输入的目标尺寸有效性
- **详细日志**：浏览器控制台显示处理过程
- **友好提示**：中文错误信息，便于理解

## 📝 使用注意事项

1. **文件要求**：支持PDF格式的发票文件、PNG/JPG/WebP格式的图片和Excel文件(.xlsx/.xls)
2. **尺寸范围**：自定义尺寸限制在1-30cm之间
3. **浏览器兼容**：需要现代浏览器支持（Chrome、Firefox、Safari等）
4. **打印设置**：打印时选择"实际尺寸"，不要缩放
5. **裁剪工具**：建议使用直尺和美工刀确保裁剪精度

## 🌟 优势特点

- **纯前端实现**：无需服务器，数据不上传，保护隐私
- **即时处理**：本地处理，响应快速
- **精确控制**：严格按照指定尺寸缩放
- **专业输出**：A4标准格式，兼容所有打印机
- **人性化设计**：针对报销场景优化的用户体验

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个工具！

---

*这个工具专为简化报销流程而设计，让电子发票完美适配各种报销单格式。*
